[2022-06-22 09:53:06,135][run.py][line:117][INFO] start training on GPU 0!
[2022-06-22 09:53:06,136][run.py][line:118][INFO] Namespace(bert_model_dir='', bert_tokenizer_dir='', bert_dim=1024, hidden_dim=300, gnn_hidden_dim=300, code_dim=192, feat_dim=1024, mlp_layers=2, gnn_layers=1, emb_dim=1024, iemocaptest=True, attn_type='rgcn', no_rel_attn=False, max_sent_len=200, no_cuda=False, dataset_name='DailyDialog', windowp=3, windowf=0, withvae=True, max_grad_norm=5.0, lr=5e-05, dropout=0.4, batch_size=8, epochs=40, tensorboard=False, nodal_att_type=None, cuda=True)
[2022-06-22 09:54:34,322][run.py][line:158][INFO] Epoch: 1, train_loss: 0.2462, train_acc: 92.61, train_micro_fscore: 73.59, train_macro_fscore: 39.94, valid_loss: 0.3112, valid_acc: 91.41, valid_micro_fscore: 59.84, valid_macro_fscore: 40.82, test_loss: 1.7771, test_acc: 29.47, test_micro_fscore: 17.1, test_macro_fscore: 17.33, time: 62.12 sec
[2022-06-22 09:55:33,375][run.py][line:158][INFO] Epoch: 2, train_loss: 0.1548, train_acc: 94.95, train_micro_fscore: 83.28, train_macro_fscore: 57.71, valid_loss: 0.3004, valid_acc: 91.54, valid_micro_fscore: 61.05, valid_macro_fscore: 43.19, test_loss: 1.5768, test_acc: 38.72, test_micro_fscore: 28.39, test_macro_fscore: 21.01, time: 59.05 sec
[2022-06-22 09:56:18,655][run.py][line:158][INFO] Epoch: 3, train_loss: 0.1459, train_acc: 95.18, train_micro_fscore: 84.26, train_macro_fscore: 62.9, valid_loss: 0.3307, valid_acc: 90.31, valid_micro_fscore: 60.29, valid_macro_fscore: 43.11, test_loss: 1.384, test_acc: 42.97, test_micro_fscore: 36.76, test_macro_fscore: 35.02, time: 45.28 sec
[2022-06-22 09:57:28,693][run.py][line:158][INFO] Epoch: 4, train_loss: 0.1439, train_acc: 95.23, train_micro_fscore: 84.67, train_macro_fscore: 66.6, valid_loss: 0.2865, valid_acc: 90.77, valid_micro_fscore: 60.68, valid_macro_fscore: 43.15, test_loss: 1.344, test_acc: 47.6, test_micro_fscore: 42.08, test_macro_fscore: 34.4, time: 70.04 sec
[2022-06-22 09:58:37,670][run.py][line:158][INFO] Epoch: 5, train_loss: 0.1409, train_acc: 95.33, train_micro_fscore: 84.89, train_macro_fscore: 69.06, valid_loss: 0.3144, valid_acc: 91.23, valid_micro_fscore: 61.12, valid_macro_fscore: 42.81, test_loss: 1.3215, test_acc: 52.47, test_micro_fscore: 47.03, test_macro_fscore: 43.38, time: 68.98 sec
[2022-06-22 09:59:31,730][run.py][line:158][INFO] Epoch: 6, train_loss: 0.1389, train_acc: 95.41, train_micro_fscore: 85.22, train_macro_fscore: 73.5, valid_loss: 0.2897, valid_acc: 91.13, valid_micro_fscore: 61.51, valid_macro_fscore: 45.9, test_loss: 1.3725, test_acc: 51.54, test_micro_fscore: 45.73, test_macro_fscore: 39.34, time: 54.06 sec
[2022-06-22 10:00:28,821][run.py][line:158][INFO] Epoch: 7, train_loss: 0.1383, train_acc: 95.41, train_micro_fscore: 85.35, train_macro_fscore: 75.33, valid_loss: 0.2931, valid_acc: 91.35, valid_micro_fscore: 61.27, valid_macro_fscore: 47.67, test_loss: 1.419, test_acc: 49.2, test_micro_fscore: 41.9, test_macro_fscore: 34.87, time: 57.09 sec
[2022-06-22 10:01:28,955][run.py][line:158][INFO] Epoch: 8, train_loss: 0.1348, train_acc: 95.47, train_micro_fscore: 85.5, train_macro_fscore: 75.64, valid_loss: 0.3077, valid_acc: 91.09, valid_micro_fscore: 61.57, valid_macro_fscore: 46.24, test_loss: 1.4136, test_acc: 50.49, test_micro_fscore: 44.77, test_macro_fscore: 37.55, time: 60.13 sec
[2022-06-22 10:02:12,017][run.py][line:158][INFO] Epoch: 9, train_loss: 0.1343, train_acc: 95.47, train_micro_fscore: 85.54, train_macro_fscore: 76.06, valid_loss: 0.3037, valid_acc: 91.09, valid_micro_fscore: 61.63, valid_macro_fscore: 48.25, test_loss: 1.3415, test_acc: 52.65, test_micro_fscore: 46.77, test_macro_fscore: 40.19, time: 43.06 sec
[2022-06-22 10:03:22,830][run.py][line:158][INFO] Epoch: 10, train_loss: 0.1326, train_acc: 95.55, train_micro_fscore: 85.78, train_macro_fscore: 77.53, valid_loss: 0.2895, valid_acc: 91.04, valid_micro_fscore: 61.41, valid_macro_fscore: 46.15, test_loss: 1.358, test_acc: 53.14, test_micro_fscore: 47.6, test_macro_fscore: 40.86, time: 70.81 sec
[2022-06-22 10:04:29,043][run.py][line:158][INFO] Epoch: 11, train_loss: 0.1312, train_acc: 95.57, train_micro_fscore: 85.92, train_macro_fscore: 77.95, valid_loss: 0.2895, valid_acc: 91.54, valid_micro_fscore: 60.72, valid_macro_fscore: 46.72, test_loss: 1.4414, test_acc: 47.47, test_micro_fscore: 40.38, test_macro_fscore: 34.1, time: 66.21 sec
[2022-06-22 10:05:15,207][run.py][line:158][INFO] Epoch: 12, train_loss: 0.1293, train_acc: 95.57, train_micro_fscore: 85.87, train_macro_fscore: 77.23, valid_loss: 0.2885, valid_acc: 91.49, valid_micro_fscore: 61.17, valid_macro_fscore: 47.31, test_loss: 1.3347, test_acc: 56.29, test_micro_fscore: 50.6, test_macro_fscore: 48.11, time: 46.16 sec
[2022-06-22 10:06:22,031][run.py][line:158][INFO] Epoch: 13, train_loss: 0.1285, train_acc: 95.63, train_micro_fscore: 86.1, train_macro_fscore: 78.2, valid_loss: 0.2976, valid_acc: 90.97, valid_micro_fscore: 61.2, valid_macro_fscore: 47.76, test_loss: 1.2721, test_acc: 60.23, test_micro_fscore: 55.9, test_macro_fscore: 55.33, time: 66.82 sec
[2022-06-22 10:07:21,022][run.py][line:158][INFO] Epoch: 14, train_loss: 0.1265, train_acc: 95.66, train_micro_fscore: 86.24, train_macro_fscore: 78.53, valid_loss: 0.2933, valid_acc: 91.42, valid_micro_fscore: 60.97, valid_macro_fscore: 46.53, test_loss: 1.3696, test_acc: 55.86, test_micro_fscore: 50.59, test_macro_fscore: 47.68, time: 58.99 sec
[2022-06-22 10:08:21,834][run.py][line:158][INFO] Epoch: 15, train_loss: 0.1258, train_acc: 95.64, train_micro_fscore: 86.19, train_macro_fscore: 78.95, valid_loss: 0.3164, valid_acc: 90.94, valid_micro_fscore: 61.18, valid_macro_fscore: 47.75, test_loss: 1.5798, test_acc: 48.15, test_micro_fscore: 40.71, test_macro_fscore: 34.63, time: 60.81 sec
[2022-06-22 10:08:58,652][run.py][line:158][INFO] Epoch: 16, train_loss: 0.1245, train_acc: 95.7, train_micro_fscore: 86.37, train_macro_fscore: 79.08, valid_loss: 0.299, valid_acc: 91.19, valid_micro_fscore: 60.73, valid_macro_fscore: 46.88, test_loss: 1.3794, test_acc: 54.81, test_micro_fscore: 48.75, test_macro_fscore: 46.9, time: 36.82 sec
[2022-06-22 10:10:05,336][run.py][line:158][INFO] Epoch: 17, train_loss: 0.1238, train_acc: 95.73, train_micro_fscore: 86.53, train_macro_fscore: 79.2, valid_loss: 0.2975, valid_acc: 91.26, valid_micro_fscore: 61.74, valid_macro_fscore: 49.13, test_loss: 1.7342, test_acc: 46.05, test_micro_fscore: 37.69, test_macro_fscore: 33.23, time: 66.68 sec
[2022-06-22 10:11:14,767][run.py][line:158][INFO] Epoch: 18, train_loss: 0.1216, train_acc: 95.77, train_micro_fscore: 86.63, train_macro_fscore: 79.19, valid_loss: 0.284, valid_acc: 91.24, valid_micro_fscore: 60.86, valid_macro_fscore: 46.75, test_loss: 1.5812, test_acc: 51.79, test_micro_fscore: 44.58, test_macro_fscore: 40.55, time: 69.43 sec
[2022-06-22 10:12:00,007][run.py][line:158][INFO] Epoch: 19, train_loss: 0.12, train_acc: 95.76, train_micro_fscore: 86.57, train_macro_fscore: 79.8, valid_loss: 0.3004, valid_acc: 91.11, valid_micro_fscore: 61.71, valid_macro_fscore: 48.21, test_loss: 1.4358, test_acc: 55.67, test_micro_fscore: 50.71, test_macro_fscore: 42.02, time: 45.24 sec
[2022-06-22 10:12:58,039][run.py][line:158][INFO] Epoch: 20, train_loss: 0.119, train_acc: 95.81, train_micro_fscore: 86.81, train_macro_fscore: 80.16, valid_loss: 0.3102, valid_acc: 91.6, valid_micro_fscore: 60.83, valid_macro_fscore: 48.14, test_loss: 1.8131, test_acc: 46.05, test_micro_fscore: 37.67, test_macro_fscore: 31.71, time: 58.03 sec
[2022-06-22 10:14:17,993][run.py][line:158][INFO] Epoch: 21, train_loss: 0.1185, train_acc: 95.82, train_micro_fscore: 86.88, train_macro_fscore: 80.76, valid_loss: 0.3057, valid_acc: 91.29, valid_micro_fscore: 61.13, valid_macro_fscore: 47.48, test_loss: 1.656, test_acc: 52.34, test_micro_fscore: 45.94, test_macro_fscore: 37.74, time: 79.95 sec
[2022-06-22 10:15:07,986][run.py][line:158][INFO] Epoch: 22, train_loss: 0.1164, train_acc: 95.81, train_micro_fscore: 86.87, train_macro_fscore: 80.35, valid_loss: 0.3086, valid_acc: 90.97, valid_micro_fscore: 61.15, valid_macro_fscore: 47.36, test_loss: 1.9762, test_acc: 46.61, test_micro_fscore: 38.38, test_macro_fscore: 33.38, time: 49.99 sec
[2022-06-22 10:16:21,835][run.py][line:158][INFO] Epoch: 23, train_loss: 0.1146, train_acc: 95.88, train_micro_fscore: 87.09, train_macro_fscore: 81.34, valid_loss: 0.3475, valid_acc: 91.31, valid_micro_fscore: 61.56, valid_macro_fscore: 46.37, test_loss: 1.7825, test_acc: 49.51, test_micro_fscore: 41.98, test_macro_fscore: 39.05, time: 73.85 sec
[2022-06-22 10:17:35,374][run.py][line:158][INFO] Epoch: 24, train_loss: 0.1133, train_acc: 95.93, train_micro_fscore: 87.23, train_macro_fscore: 82.2, valid_loss: 0.3307, valid_acc: 91.04, valid_micro_fscore: 61.06, valid_macro_fscore: 46.65, test_loss: 2.1679, test_acc: 46.05, test_micro_fscore: 38.47, test_macro_fscore: 32.85, time: 73.54 sec
[2022-06-22 10:18:55,495][run.py][line:158][INFO] Epoch: 25, train_loss: 0.1116, train_acc: 95.92, train_micro_fscore: 87.27, train_macro_fscore: 82.47, valid_loss: 0.2987, valid_acc: 91.31, valid_micro_fscore: 60.74, valid_macro_fscore: 47.7, test_loss: 1.7325, test_acc: 51.73, test_micro_fscore: 45.47, test_macro_fscore: 42.43, time: 80.12 sec
[2022-06-22 10:20:09,480][run.py][line:158][INFO] Epoch: 26, train_loss: 0.1108, train_acc: 95.98, train_micro_fscore: 87.47, train_macro_fscore: 83.32, valid_loss: 0.3066, valid_acc: 91.34, valid_micro_fscore: 61.46, valid_macro_fscore: 47.89, test_loss: 1.8553, test_acc: 47.1, test_micro_fscore: 40.66, test_macro_fscore: 32.46, time: 73.99 sec
[2022-06-22 10:21:11,714][run.py][line:158][INFO] Epoch: 27, train_loss: 0.108, train_acc: 96.04, train_micro_fscore: 87.68, train_macro_fscore: 82.56, valid_loss: 0.3057, valid_acc: 91.34, valid_micro_fscore: 61.67, valid_macro_fscore: 48.8, test_loss: 1.8712, test_acc: 51.36, test_micro_fscore: 45.23, test_macro_fscore: 38.8, time: 62.23 sec
[2022-06-22 10:22:34,375][run.py][line:158][INFO] Epoch: 28, train_loss: 0.1066, train_acc: 96.07, train_micro_fscore: 87.79, train_macro_fscore: 83.14, valid_loss: 0.3251, valid_acc: 91.36, valid_micro_fscore: 60.64, valid_macro_fscore: 47.02, test_loss: 1.9572, test_acc: 48.83, test_micro_fscore: 41.61, test_macro_fscore: 37.74, time: 82.66 sec
[2022-06-22 10:23:46,145][run.py][line:158][INFO] Epoch: 29, train_loss: 0.1052, train_acc: 96.11, train_micro_fscore: 87.85, train_macro_fscore: 83.27, valid_loss: 0.3316, valid_acc: 91.56, valid_micro_fscore: 60.33, valid_macro_fscore: 46.26, test_loss: 2.034, test_acc: 51.48, test_micro_fscore: 45.21, test_macro_fscore: 34.66, time: 71.77 sec
[2022-06-22 10:24:47,141][run.py][line:158][INFO] Epoch: 30, train_loss: 0.103, train_acc: 96.09, train_micro_fscore: 87.91, train_macro_fscore: 84.48, valid_loss: 0.3434, valid_acc: 91.08, valid_micro_fscore: 60.7, valid_macro_fscore: 45.53, test_loss: 2.4042, test_acc: 43.46, test_micro_fscore: 34.81, test_macro_fscore: 26.79, time: 61.0 sec
[2022-06-22 10:25:51,111][run.py][line:158][INFO] Epoch: 31, train_loss: 0.1024, train_acc: 96.19, train_micro_fscore: 88.22, train_macro_fscore: 84.76, valid_loss: 0.3803, valid_acc: 91.29, valid_micro_fscore: 60.66, valid_macro_fscore: 43.14, test_loss: 2.371, test_acc: 44.08, test_micro_fscore: 35.83, test_macro_fscore: 30.63, time: 63.97 sec
[2022-06-22 10:26:35,447][run.py][line:158][INFO] Epoch: 32, train_loss: 0.1005, train_acc: 96.21, train_micro_fscore: 88.36, train_macro_fscore: 85.12, valid_loss: 0.3643, valid_acc: 91.24, valid_micro_fscore: 60.68, valid_macro_fscore: 47.6, test_loss: 2.462, test_acc: 47.84, test_micro_fscore: 40.72, test_macro_fscore: 31.3, time: 44.34 sec
[2022-06-22 10:27:09,458][run.py][line:158][INFO] Epoch: 33, train_loss: 0.0985, train_acc: 96.22, train_micro_fscore: 88.36, train_macro_fscore: 84.83, valid_loss: 0.3723, valid_acc: 91.42, valid_micro_fscore: 60.85, valid_macro_fscore: 48.26, test_loss: 2.8164, test_acc: 46.98, test_micro_fscore: 40.11, test_macro_fscore: 31.71, time: 34.01 sec
[2022-06-22 10:27:46,174][run.py][line:158][INFO] Epoch: 34, train_loss: 0.097, train_acc: 96.24, train_micro_fscore: 88.5, train_macro_fscore: 85.11, valid_loss: 0.3594, valid_acc: 91.45, valid_micro_fscore: 60.18, valid_macro_fscore: 44.84, test_loss: 2.3301, test_acc: 48.95, test_micro_fscore: 42.66, test_macro_fscore: 38.81, time: 36.72 sec
[2022-06-22 10:28:45,329][run.py][line:158][INFO] Epoch: 35, train_loss: 0.095, train_acc: 96.29, train_micro_fscore: 88.62, train_macro_fscore: 85.92, valid_loss: 0.3941, valid_acc: 90.46, valid_micro_fscore: 60.14, valid_macro_fscore: 46.7, test_loss: 2.4326, test_acc: 53.27, test_micro_fscore: 47.89, test_macro_fscore: 39.12, time: 59.15 sec
[2022-06-22 10:29:46,388][run.py][line:158][INFO] Epoch: 36, train_loss: 0.0936, train_acc: 96.36, train_micro_fscore: 88.85, train_macro_fscore: 86.16, valid_loss: 0.4101, valid_acc: 90.97, valid_micro_fscore: 60.87, valid_macro_fscore: 46.05, test_loss: 3.1934, test_acc: 46.73, test_micro_fscore: 39.89, test_macro_fscore: 31.07, time: 61.06 sec
[2022-06-22 10:30:42,871][run.py][line:158][INFO] Epoch: 37, train_loss: 0.0933, train_acc: 96.37, train_micro_fscore: 88.91, train_macro_fscore: 85.96, valid_loss: 0.3843, valid_acc: 90.73, valid_micro_fscore: 60.4, valid_macro_fscore: 47.52, test_loss: 2.3842, test_acc: 46.42, test_micro_fscore: 39.84, test_macro_fscore: 32.11, time: 56.48 sec
[2022-06-22 10:31:46,932][run.py][line:158][INFO] Epoch: 38, train_loss: 0.0903, train_acc: 96.41, train_micro_fscore: 89.04, train_macro_fscore: 86.88, valid_loss: 0.4093, valid_acc: 90.99, valid_micro_fscore: 60.74, valid_macro_fscore: 45.97, test_loss: 2.938, test_acc: 50.68, test_micro_fscore: 44.87, test_macro_fscore: 36.74, time: 64.06 sec
[2022-06-22 10:32:52,284][run.py][line:158][INFO] Epoch: 39, train_loss: 0.0898, train_acc: 96.47, train_micro_fscore: 89.26, train_macro_fscore: 87.17, valid_loss: 0.4078, valid_acc: 91.25, valid_micro_fscore: 60.3, valid_macro_fscore: 47.68, test_loss: 2.3403, test_acc: 53.14, test_micro_fscore: 47.97, test_macro_fscore: 38.29, time: 65.35 sec
[2022-06-22 10:34:04,204][run.py][line:158][INFO] Epoch: 40, train_loss: 0.0879, train_acc: 96.45, train_micro_fscore: 89.18, train_macro_fscore: 87.02, valid_loss: 0.4373, valid_acc: 90.72, valid_micro_fscore: 60.69, valid_macro_fscore: 48.26, test_loss: 2.7811, test_acc: 46.86, test_micro_fscore: 40.36, test_macro_fscore: 36.31, time: 71.92 sec
[2022-06-22 10:34:04,205][run.py][line:184][INFO] finish training!
[2022-06-22 10:34:04,205][run.py][line:196][INFO] Best micro/macro F-Score based on validation:37.69/33.23
[2022-06-22 10:34:04,205][run.py][line:198][INFO] Best micro/macro F-Score based on test:55.9/55.33
